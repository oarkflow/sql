puts("=== Security Test with Multi-Return ===")

// 1. Try to read a file outside the project
puts("Attempting to access /etc/passwd...")
let content, err = read_file("/etc/passwd")

if (err != null) {
	puts("Blocked successfully: " + err)
} else {
	puts("SECURITY FAILURE: Could read /etc/passwd")
}

// 2. Try to write a file outside
puts("Attempting to write ../../hacked.txt...")
let ok, wErr = write_file("../../hacked.txt", "hacked")
if (wErr != null) {
	puts("Blocked write: " + wErr)
} else {
	puts("SECURITY FAILURE: Could write file")
}

// 3. Valid access check
puts("Attempting valid read (main.go)...")

let mainContent, mainErr = read_file("main.go")

if (mainErr == null) {
	puts("Success: Valid file read")
} else {
	puts("Unexpected Error: " + mainErr)
}
