print "Testing System Features";

print "ARGS:";
puts(ARGS);

print "Environment Variables:";
os_env("SPL_TEST", "123");
let val = os_env("SPL_TEST");
print "SPL_TEST = " + val;

if (val != "123") {
    print "Error: Environment variable not set correctly";
    exit(1);
}

print "Math:";
print "abs(-10) = " + to_string(abs(-10));
let r = random(100);
print "random(100) = " + to_string(r);

print "Time:";
let t1 = time();
print "sleeping 100ms...";
sleep(100);
let t2 = time();
// Note: unix timestamp is in seconds, so it might not change if < 1s.
// But we executed.

print "File Checks:";
write_file("exists.txt", "here");
if (file_exists("exists.txt")) {
    print "File exists";
} else {
    print "Error: File should exist";
    exit(1);
}
remove_file("exists.txt");
if (file_exists("exists.txt")) {
    print "Error: File should be removed";
    exit(1);
} else {
    print "File removed";
}

print "Exec:";
// echo hello
let output = exec("echo", "hello exec");
// output might have newline
print "Exec output: " + output;

print "Type Conversion:";
let n = to_int("42") + 10;
print "42 + 10 = " + to_string(n);

print "Done";
exit(0);
